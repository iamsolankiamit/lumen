{"version":3,"sources":["webpack:///path---posts-cors-in-ruby-on-rails-59959c35f2416108a278.js","webpack:///./.cache/json/posts-cors-in-ruby-on-rails.json"],"names":["webpackJsonp","401","module","exports","data","site","siteMetadata","title","subtitle","author","name","twitter","disqusShortname","url","markdownRemark","id","html","fields","tagSlugs","frontmatter","tags","date","description","pathContext","slug"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,MAAQC,cAAgBC,MAAA,uBAAAC,SAAA,6DAAAC,QAAiHC,KAAA,eAAAC,QAAA,kBAAiDC,gBAAA,GAAAC,IAAA,2BAAsDC,gBAAmBC,GAAA,uIAAAC,KAAA,q0NAAg9IC,QAAkvFC,UAAA,wFAAmGC,aAAgBZ,MAAA,8CAAAa,MAAA,oDAAAC,KAAA,2BAAAC,YAAA,yDAA0NC,aAAgBC,KAAA","file":"path---posts-cors-in-ruby-on-rails-59959c35f2416108a278.js","sourcesContent":["webpackJsonp([105394791004355],{\n\n/***/ 401:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"site\":{\"siteMetadata\":{\"title\":\"Blog by Amit Solanki\",\"subtitle\":\"I develop in and write about Javascript, Reason, and React\",\"author\":{\"name\":\"Amit Solanki\",\"twitter\":\"iamsolankiamit\"},\"disqusShortname\":\"\",\"url\":\"http://solankiamit.com\"}},\"markdownRemark\":{\"id\":\"/Users/mohitprakash/projects/lumen/src/pages/articles/2019-20-01---CORS-in-Ruby-on-Rails/index.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>Building a client side app with React is a bliss, just like building backend with Ruby on Rails. In React if you make an api to call to backed you would get an error like so.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">Response to preflight request doesn‚Äôt pass access control check: No ‚ÄòAccess-Control-Allow-Origin‚Äô header is present on the requested resource. Origin ‚Äòhttp://localhost:4000&#39; is therefore not allowed access. The response had HTTP status code 404. If an opaque response serves your needs, set the request‚Äôs mode to ‚Äòno-cors‚Äô to fetch the resource with CORS disabled.</code></pre>\\n      </div>\\n<p>CORS or Cross Origin Resource Sharing gives web server cross domain access control, which enables secure cross-domain data transfers. Browsers use CORS in an API container, such as <a href=\\\"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\\\">XMLHttpRequest</a> (what <a href=\\\"https://github.com/axios/axios\\\">Axios</a> and <a href=\\\"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API\\\">Fetch</a> use under the hood), to mitigate the risks of cross-origin HTTP requests.</p>\\n<p>To fix this, we have 2 options.</p>\\n<ol>\\n<li>Set request mode to ‚Äòno-cors‚Äô to fetch the resource with CORS disabled, this will return an opaque response.</li>\\n<li>Add an ‚ÄòAccess-Control-Allow-Origin‚Äô header to rails server.</li>\\n</ol>\\n<p>If we set ‚Äòno-cors‚Äô it returns the following Opaque response.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\">Response <span class=\\\"token punctuation\\\">{</span>\\n  body<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">null</span>\\n  bodyUsed<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">false</span>\\n  headers<span class=\\\"token punctuation\\\">:</span> Headers\\n  ok<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">false</span>\\n  redirected<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">false</span>\\n  status<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token number\\\">0</span>\\n  statusText<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"\\\"</span>\\n  type<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"opaque\\\"</span>\\n  url<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"\\\"</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>There are a couple of things to note:</p>\\n<ul>\\n<li>the <code class=\\\"language-text\\\">status</code> is ‚Äú0‚Äù (and not a regular HTTP status code - like 200)</li>\\n<li>the <code class=\\\"language-text\\\">statusText</code> is empty</li>\\n<li>the <code class=\\\"language-text\\\">headers</code> object is also empty\\nBasically, we can‚Äôt see anything in this <code class=\\\"language-text\\\">Response</code> object - and henceforth the name opaque. Opaque response or ‚Äòno-cors‚Äô mode can be used with <code class=\\\"language-text\\\">&lt;script&gt;</code>, <code class=\\\"language-text\\\">&lt;img&gt;</code>, <code class=\\\"language-text\\\">&lt;video&gt;</code>, <code class=\\\"language-text\\\">&lt;audio&gt;</code>, <code class=\\\"language-text\\\">&lt;link rel=&quot;stylesheet&quot;&gt;</code>, <code class=\\\"language-text\\\">&lt;object&gt;</code>, <code class=\\\"language-text\\\">&lt;embed&gt;</code> and <code class=\\\"language-text\\\">&lt;iframe&gt;</code> elements.</li>\\n</ul>\\n<p>So it‚Äôs of no use to us, given that we need the data from our rails api. We need to add the <code class=\\\"language-text\\\">Access-Control-Allow-Origin</code> header to the rails server. We can use this wonderful gem <a href=\\\"https://github.com/cyu/rack-cors\\\">rack-cors</a>. We need to add the gem to our Gemfile.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\">gem <span class=\\\"token string\\\">'rack-cors'</span></code></pre>\\n      </div>\\n<p>And add the following config in <code class=\\\"language-text\\\">config/application.rb</code> file</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\"><span class=\\\"token keyword\\\">module</span> <span class=\\\"token constant\\\">YourApp</span>\\n  <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Application</span> <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token constant\\\">Rails</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token constant\\\">Application</span>\\n    <span class=\\\"token comment\\\"># ...</span>\\n\\n    <span class=\\\"token comment\\\"># Rails 5</span>\\n\\n    config<span class=\\\"token punctuation\\\">.</span>middleware<span class=\\\"token punctuation\\\">.</span>insert_before <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token constant\\\">Rack</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token constant\\\">Cors</span> <span class=\\\"token keyword\\\">do</span>\\n      allow <span class=\\\"token keyword\\\">do</span>\\n        origins <span class=\\\"token string\\\">'*'</span>\\n        resource <span class=\\\"token string\\\">'*'</span><span class=\\\"token punctuation\\\">,</span> headers<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token symbol\\\">:any</span><span class=\\\"token punctuation\\\">,</span> methods<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token symbol\\\">:get</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token symbol\\\">:post</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token symbol\\\">:options</span><span class=\\\"token punctuation\\\">]</span>\\n      <span class=\\\"token keyword\\\">end</span>\\n    <span class=\\\"token keyword\\\">end</span>\\n\\n    <span class=\\\"token comment\\\"># Rails 3/4</span>\\n\\n    config<span class=\\\"token punctuation\\\">.</span>middleware<span class=\\\"token punctuation\\\">.</span>insert_before <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Rack::Cors\\\"</span> <span class=\\\"token keyword\\\">do</span>\\n      allow <span class=\\\"token keyword\\\">do</span>\\n        origins <span class=\\\"token string\\\">'*'</span>\\n        resource <span class=\\\"token string\\\">'*'</span><span class=\\\"token punctuation\\\">,</span> headers<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token symbol\\\">:any</span><span class=\\\"token punctuation\\\">,</span> methods<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token symbol\\\">:get</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token symbol\\\">:post</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token symbol\\\">:options</span><span class=\\\"token punctuation\\\">]</span>\\n      <span class=\\\"token keyword\\\">end</span>\\n    <span class=\\\"token keyword\\\">end</span>\\n  <span class=\\\"token keyword\\\">end</span>\\n<span class=\\\"token keyword\\\">end</span></code></pre>\\n      </div>\\n<p>That‚Äôs about it, no more CORS issue. üöÄ We are good to go.</p>\",\"fields\":{\"tagSlugs\":[\"/tags/rails/\",\"/tags/cors/\",\"/tags/javascript/\",\"/tags/ruby/\",\"/tags/ruby-on-rails/\"]},\"frontmatter\":{\"title\":\"Handling CORS in Rails for client side apps\",\"tags\":[\"Rails\",\"CORS\",\"Javascript\",\"ruby\",\"Ruby on Rails\"],\"date\":\"2019-01-20T21:20:50.129Z\",\"description\":\"Handling CORS in Rails for JS apps using React, etc\"}}},\"pathContext\":{\"slug\":\"/posts/CORS-in-Ruby-On-Rails\"}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---posts-cors-in-ruby-on-rails-59959c35f2416108a278.js","module.exports = {\"data\":{\"site\":{\"siteMetadata\":{\"title\":\"Blog by Amit Solanki\",\"subtitle\":\"I develop in and write about Javascript, Reason, and React\",\"author\":{\"name\":\"Amit Solanki\",\"twitter\":\"iamsolankiamit\"},\"disqusShortname\":\"\",\"url\":\"http://solankiamit.com\"}},\"markdownRemark\":{\"id\":\"/Users/mohitprakash/projects/lumen/src/pages/articles/2019-20-01---CORS-in-Ruby-on-Rails/index.md absPath of file >>> MarkdownRemark\",\"html\":\"<p>Building a client side app with React is a bliss, just like building backend with Ruby on Rails. In React if you make an api to call to backed you would get an error like so.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-text\\\"><code class=\\\"language-text\\\">Response to preflight request doesn‚Äôt pass access control check: No ‚ÄòAccess-Control-Allow-Origin‚Äô header is present on the requested resource. Origin ‚Äòhttp://localhost:4000&#39; is therefore not allowed access. The response had HTTP status code 404. If an opaque response serves your needs, set the request‚Äôs mode to ‚Äòno-cors‚Äô to fetch the resource with CORS disabled.</code></pre>\\n      </div>\\n<p>CORS or Cross Origin Resource Sharing gives web server cross domain access control, which enables secure cross-domain data transfers. Browsers use CORS in an API container, such as <a href=\\\"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\\\">XMLHttpRequest</a> (what <a href=\\\"https://github.com/axios/axios\\\">Axios</a> and <a href=\\\"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API\\\">Fetch</a> use under the hood), to mitigate the risks of cross-origin HTTP requests.</p>\\n<p>To fix this, we have 2 options.</p>\\n<ol>\\n<li>Set request mode to ‚Äòno-cors‚Äô to fetch the resource with CORS disabled, this will return an opaque response.</li>\\n<li>Add an ‚ÄòAccess-Control-Allow-Origin‚Äô header to rails server.</li>\\n</ol>\\n<p>If we set ‚Äòno-cors‚Äô it returns the following Opaque response.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-js\\\"><code class=\\\"language-js\\\">Response <span class=\\\"token punctuation\\\">{</span>\\n  body<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token keyword\\\">null</span>\\n  bodyUsed<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">false</span>\\n  headers<span class=\\\"token punctuation\\\">:</span> Headers\\n  ok<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">false</span>\\n  redirected<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token boolean\\\">false</span>\\n  status<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token number\\\">0</span>\\n  statusText<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"\\\"</span>\\n  type<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"opaque\\\"</span>\\n  url<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token string\\\">\\\"\\\"</span>\\n<span class=\\\"token punctuation\\\">}</span></code></pre>\\n      </div>\\n<p>There are a couple of things to note:</p>\\n<ul>\\n<li>the <code class=\\\"language-text\\\">status</code> is ‚Äú0‚Äù (and not a regular HTTP status code - like 200)</li>\\n<li>the <code class=\\\"language-text\\\">statusText</code> is empty</li>\\n<li>the <code class=\\\"language-text\\\">headers</code> object is also empty\\nBasically, we can‚Äôt see anything in this <code class=\\\"language-text\\\">Response</code> object - and henceforth the name opaque. Opaque response or ‚Äòno-cors‚Äô mode can be used with <code class=\\\"language-text\\\">&lt;script&gt;</code>, <code class=\\\"language-text\\\">&lt;img&gt;</code>, <code class=\\\"language-text\\\">&lt;video&gt;</code>, <code class=\\\"language-text\\\">&lt;audio&gt;</code>, <code class=\\\"language-text\\\">&lt;link rel=&quot;stylesheet&quot;&gt;</code>, <code class=\\\"language-text\\\">&lt;object&gt;</code>, <code class=\\\"language-text\\\">&lt;embed&gt;</code> and <code class=\\\"language-text\\\">&lt;iframe&gt;</code> elements.</li>\\n</ul>\\n<p>So it‚Äôs of no use to us, given that we need the data from our rails api. We need to add the <code class=\\\"language-text\\\">Access-Control-Allow-Origin</code> header to the rails server. We can use this wonderful gem <a href=\\\"https://github.com/cyu/rack-cors\\\">rack-cors</a>. We need to add the gem to our Gemfile.</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\">gem <span class=\\\"token string\\\">'rack-cors'</span></code></pre>\\n      </div>\\n<p>And add the following config in <code class=\\\"language-text\\\">config/application.rb</code> file</p>\\n<div class=\\\"gatsby-highlight\\\">\\n      <pre class=\\\"language-ruby\\\"><code class=\\\"language-ruby\\\"><span class=\\\"token keyword\\\">module</span> <span class=\\\"token constant\\\">YourApp</span>\\n  <span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">Application</span> <span class=\\\"token operator\\\">&lt;</span> <span class=\\\"token constant\\\">Rails</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token constant\\\">Application</span>\\n    <span class=\\\"token comment\\\"># ...</span>\\n\\n    <span class=\\\"token comment\\\"># Rails 5</span>\\n\\n    config<span class=\\\"token punctuation\\\">.</span>middleware<span class=\\\"token punctuation\\\">.</span>insert_before <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token constant\\\">Rack</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token constant\\\">Cors</span> <span class=\\\"token keyword\\\">do</span>\\n      allow <span class=\\\"token keyword\\\">do</span>\\n        origins <span class=\\\"token string\\\">'*'</span>\\n        resource <span class=\\\"token string\\\">'*'</span><span class=\\\"token punctuation\\\">,</span> headers<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token symbol\\\">:any</span><span class=\\\"token punctuation\\\">,</span> methods<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token symbol\\\">:get</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token symbol\\\">:post</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token symbol\\\">:options</span><span class=\\\"token punctuation\\\">]</span>\\n      <span class=\\\"token keyword\\\">end</span>\\n    <span class=\\\"token keyword\\\">end</span>\\n\\n    <span class=\\\"token comment\\\"># Rails 3/4</span>\\n\\n    config<span class=\\\"token punctuation\\\">.</span>middleware<span class=\\\"token punctuation\\\">.</span>insert_before <span class=\\\"token number\\\">0</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token string\\\">\\\"Rack::Cors\\\"</span> <span class=\\\"token keyword\\\">do</span>\\n      allow <span class=\\\"token keyword\\\">do</span>\\n        origins <span class=\\\"token string\\\">'*'</span>\\n        resource <span class=\\\"token string\\\">'*'</span><span class=\\\"token punctuation\\\">,</span> headers<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token symbol\\\">:any</span><span class=\\\"token punctuation\\\">,</span> methods<span class=\\\"token punctuation\\\">:</span> <span class=\\\"token punctuation\\\">[</span><span class=\\\"token symbol\\\">:get</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token symbol\\\">:post</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token symbol\\\">:options</span><span class=\\\"token punctuation\\\">]</span>\\n      <span class=\\\"token keyword\\\">end</span>\\n    <span class=\\\"token keyword\\\">end</span>\\n  <span class=\\\"token keyword\\\">end</span>\\n<span class=\\\"token keyword\\\">end</span></code></pre>\\n      </div>\\n<p>That‚Äôs about it, no more CORS issue. üöÄ We are good to go.</p>\",\"fields\":{\"tagSlugs\":[\"/tags/rails/\",\"/tags/cors/\",\"/tags/javascript/\",\"/tags/ruby/\",\"/tags/ruby-on-rails/\"]},\"frontmatter\":{\"title\":\"Handling CORS in Rails for client side apps\",\"tags\":[\"Rails\",\"CORS\",\"Javascript\",\"ruby\",\"Ruby on Rails\"],\"date\":\"2019-01-20T21:20:50.129Z\",\"description\":\"Handling CORS in Rails for JS apps using React, etc\"}}},\"pathContext\":{\"slug\":\"/posts/CORS-in-Ruby-On-Rails\"}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/posts-cors-in-ruby-on-rails.json\n// module id = 401\n// module chunks = 105394791004355"],"sourceRoot":""}